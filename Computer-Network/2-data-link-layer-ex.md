# 数据链路层习题

## 数据链路层功能

**例题** 数据链路层协议的功能不包括()。

$A.$定义数据格式

$B.$提供结点之间的可靠传输

$C.$控制对物理传输介质的访问

$D.$为终端结点隐蔽物理传输的细节

解：$D$。数据链路层的主要功能包括组帧，组帧即定义数据格式，$A$正确。数据链路层在物理层提供的不可靠的物理连接上实现结点到结点的可靠性传输，$B$正确。控制对物理传输介质的访问由数据链路层的介质访问控制（$MAC$）子层完成，$C$正确。数据链路层不必考虑物理层如何实现比特传输的细节，因此$D$错误。

**例题** 为了避免传输过程中帧的丢失，数据链路层采用的方法是()。

$A.$帧编号机制

$B.$循环冗余校验码

$C.$汉明码

$D.$计时器超时重发

解：$D$。为防止在传输过程中帧丢失，在可靠的数据链路层协议中，发送方对发送的每个数据帧设计一个定时器，当计时器到期而该帧的确认帧仍未到达时，发送方重发该帧。为保证接收方不会接收到重复帧，需要对每个发送的帧进行编号。汉明码和循环冗余校验码都用于差错控制。

## 组帧

**例题** 在一个数据链路协议中使用下列字符编码：

$A\,01000111$；$B\,11100011$；$ESC\,11100000$；$FLAG\,01111110$

在使用下列成帧方法的情况下，说明为传送$4$个字符$A$、$B$、$ESC$、$FLAG$所组织的帧而实际发送的二进制位序列（使用$FLAG$作为首尾标志，$ESC$作为转义字符）。

1）字符计数法。

2）使用字符填充的首尾定界法。

3）使用比特填充的首尾标志法。

1）解：第一字节为所传输的字符计数$5$，转换为二进制为$00000101$，后面依次为$A$、$B$、$ESC$、$FLAG$的二进制编码：$00000101\quad01000111\quad11100011\quad11100000\quad01111110$。

2）解：首尾标志位$FLAG$（$01111110$）在首部和尾部都需要加上，在所传输的数据中，若出现控制字符，则在该字符前插入转义字符$ESC$（$11100000$）：$01111110\quad01000111\quad11100011\quad11100000\quad11100000\quad11100000\quad01111110\quad01111110$。

3）解：首尾标志位$FLAG$（$01111110$）在首部和尾部都需要加上，在所传输的数据中，若连续出现$5$个“$1$”，则在其后插入“$0$”：$01111110\quad01000111\quad11010011\quad11100000\quad011111010\quad01111110$。

## 差错控制

### 噪声

**例题** 通过提高信噪比可以减弱其影响的差错是())。

$A.$随机差错

$B.$突发差错

$C.$数据丢失差错

$D.$干扰差错

解：$A$。一般来说，数据的传输差错是由噪声引起的。通信信道的噪声可以分为两类：热噪声和冲击噪声。热噪声一般是信道固有的，引起的差错是随机差错，可以通过提高信噪比来降低它对数据传输的影响。冲击噪声一般是由外界电磁干扰引起的，引起的差错是突发差错，它是引起传输差错的主要原因，无法通过提高信噪比来避免。

### CRC循环冗余码

**例题** 在数据传输过程中，若接收方收到的二进制比特序列为$1011\quad0011\quad010$，接收双方采用的生成多项式为$G(x)=x^4+x^3+1$，则该二进制比特序列在传输中是否出错?如果未出现差错，那么发送数据的比特序列和$CRC$检验码的比特序列分别是什么？

解：根据题意，生成多项式$G(x)$对应的二进制比特序列为$11001$。进行如下的二进制模二除法，被除数为$1011\quad0011\quad010$，除数为$11001$所得余数为0,因此该二进制比特序列在传输过程中未出现差错。发送数据的比特序列是$1011\quad001$，$CRC$检验码的比特序列是$1010$。

## 流量控制

### 停止等待协议

**例题** 如一个信道的数据传输速率为$4kb/s$，单向传播时延为$30ms$，若使用停止等待协议的信道最大利用率为$80\%$，则数据帧长度至少为多少？

解：令数据帧长度为$L$（$kb$），利用公式：信道利用率=(单位时间内发送数据的比特数÷发送方发送数据传输率)÷发送周期。

得到：$0.8=\dfrac{L}{4}\div\left(\dfrac{L}{4}+2\times0.03\right)$

最后得到$L=960b$。

### 后退N帧协议

$k$位比特编号最大接受窗口为$2^k-1$。

**例题** 数据链路层采用了$GBN$协议，发送方已经发送了编号为$0$到$7$的帧，当计时器超时时，若发送方只收到了$0$、$2$、$3$号帧的确认，则发送方需要重新发送的帧数为（）。

$A.1$&nbsp;&nbsp;&nbsp;&nbsp;$B.2$&nbsp;&nbsp;&nbsp;&nbsp;$C.3$&nbsp;&nbsp;&nbsp;&nbsp;$D.4$

解：$D$。请注意的是$GBN$是累计确认的，所以最后收到了$3$号帧的确认代表$0$、$1$、$2$、$3$号帧都确认收到了，没有收到$1$号的确认也无所谓，所以这时候就应该从$4$号帧开始重发，所以是$D$。

**例题** 两台主机之间的数据链路层采用后退$N$帧协议（$GBN$）传输数据，数据传输速率为$16kb/s$，单向传播时延为$270ms$，数据帧长度范围是$128\sim512$字节，接收方总是以与数据帧等长的帧进行确认。为使信道利用率达到最高，帧序列的比特数至少为()。

$A.2$&nbsp;&nbsp;&nbsp;&nbsp;$B.3$&nbsp;&nbsp;&nbsp;&nbsp;$C.4$&nbsp;&nbsp;&nbsp;&nbsp;$D.5$

解：$C$。已知数据帧长度范围是$128\sim512$字节，所以数据帧长度是不确定的，而要保证信道使用率最高，所以按最小数据帧长度计算（因为单向传播时延固定下，越大的数据帧信道利用率越高）。

一帧发送所需要的时间为$128\times8/(16\times10^3)=64ms$，而发送一帧到确认该帧一共需要$64+270\times2+64=668ms$，这个时间段内可以传输$668/64=10.4$帧，所以至少需要$4$为比特进行编号（$2^4=16>10.4$）。

**例题** 对于滑动窗口协议，若分组序号采用$3$比特编号，发送窗口大小为$5$，则接收窗口最大是()。

$A.2$

$B.3$

$C.4$

$D.5$

解：滑动窗口协议又分为两种后退$N$帧协议与选择重传协议，其中后退$N$帧协议接收窗口为$1$，而选择重传协议中滑动窗口数量为$2^3=8$，所以接收窗口最大为$8-5=3$。

### 选择重传协议

$k$位比特编号最大接受窗口为$2^{k-1}$，即一半。

**例题** 数据链路层采用了$SR$协议，发送方已经发送了编号为$0$到$3$的帧，若发送方只收到了$1$号帧的确认，$0$、$2$号帧依次超时，则发送方需要重新发送的帧数为（）。

$A.0$&nbsp;&nbsp;&nbsp;&nbsp;$B.1$&nbsp;&nbsp;&nbsp;&nbsp;$C.2$&nbsp;&nbsp;&nbsp;&nbsp;$D.3$

解：$C$。请注意的是$SR$是单独确认的，所以收到了$1$号帧的确认，而$0$，$2$号超时，代表这两个需要重传，所以是$C$。

**例题** 对无序接收的滑动窗口协议，若序号位数为$n$，则发送窗口最大尺寸为()。

$A.2^n-1$

$B.2n$

$C.2n-1$

$D.2^{n-1}$

解：$D$。虽然没有明确给出哪个协议，但是可以根据无序接收知道这个指选择重传协议。所以选$D$。

**例题** 在选择$ARQ$协议中，设编号用$3bit$，发送窗口$W_T=6$，接收窗口$W_R=3$。试找出一种情况，使得在此情况下协议不能正确工作。

解：对于选择重传协议，接收窗口和发送窗口的尺寸需满足：接收窗口尺寸$W_R$＋发送窗口尺寸$W_T\leqslant2^n$，而题目中给出的数据是$W_R+W_T=9\leqslant2^3$，所以是无法正常工作的。

举例如下：

发送方：$01234567012345670$

接收方：$01234567012345670$

发送方发送$0\sim5$号共$6$个数据帧时，因发送窗口已满，发送暂停。接收方收到所有数据帧，对每个帧都发送确认帧，并期待后面的$6$、$7$、$0$号帧。若所有的确认帧都未到达发送方，经过发送方计时器控制的超时时间后，发送方再次发送之前的$6$个数据帧，而接收方收到$0$号帧后，无法判断是新的数据帧还是旧的重传的数据帧。

**例题** 假定卫星信道的数据率为$100kb/s$，卫星信道的单程传播时延为$250ms$，每个数据帧的长度均为$2000$位，并且不考虑误码、确认帧长、头部和处理时间等开销，为达到传输的最大效率，试问帧的顺序号应为多少位，此时信道利用率是多少。

解：首先卫星信道的单程传播时延为$250ms$，所以$RTT=250\times2=500ms=0.5s$。

**例题** 在数据传输速率为$50kb/s$的卫星信道上传送长度为$1kbit$的帧，假设确认帧总由数据帧捎带，帧头的序号长度为$3bit$，卫星信道端到端的单向传播延迟为$270ms$。对于下面三种协议，信道的最大利用率是多少。

1）停止——等待协议。

2）后退$N$帧协议。

3）选择重传协议（假设发送窗口和接收窗口相等）。

**例题** 对于下列给定的值，不考虑差错重传，非受限协议（无须等待应答）和停止——等待协议的有效数据率是多少？（即每秒传输了多少真正的数据，单位为$b/s$。）

$R$=传输速率（$16Mb/s$）

$S$=信号传播速率（$200m/\mu s$）

$D$=接收主机和发送主机之间传播距离（$200m$）

$T$=创建帧的时间（$2\mu s$）

$F$=每帧的长度（$500bit$）

$N$=每帧中的数据长度（$450bit$）

$A$=确认帧$ACK$的帧长（$80bit$）

**例题** 在某个卫星信道上，发送端从一个方向发送长度为$512B$的帧，且发送端的数据发送速率为$64kb/s$，接收端在另一端返回一个很短的确认帧。设卫星信道端到端的单向传播延时为$270ms$，对于发送窗口尺寸分别为$1$、$7$、$17$和$117$的情况，信道的吞吐率分别为多少？

**例题** 甲乙双方均采用后退N帧协议（$GBN$）进行持续的双向数据传输，且双方始终采用捎带确认，帧长均为$1000B$。$S_{x,y}$和$R_{x,y}$分别表示甲方和乙方发送的数据帧，其中$x$是发送序号，$y$是确认序号（表示希望接收对方的下一帧序号），数据帧的发送序号和确认序号字段均为$3$比特。信道传输速率为$100Mb/s$，$RTT=0.96ms$。下图给出了甲方发送数据帧和接收数据帧的两种场景，其中$t$为初始时刻，此时甲方的发送和确认序号均为$0$，$t_1$时刻甲方有足够多的数据待发送。请回答下列问题。

1）对于图($a$)，$t_0$时刻到$t_1$时刻期间，甲方可以断定乙方已正确接收的数据帧数是多少？正确接收的是哪几个帧（请用$S_{x,y}$形式给出）？

2）对于图($a$)，从$t_1$时刻起，甲方在不出现超时且未收到乙方新的数据帧之前，最多还可以发送多少个数据帧？其中第一个帧和最后一个帧分别是哪个（请用$S_{x,y}$形式给出）？

3）对于图($b$)，从$t_1$时刻起，甲方在不出现新的超时且未收到乙方新的数据帧之前，需要重发多少个数据帧？重发的第一个帧是哪个帧（请用$S_{x,y}$形式给出）？

4）甲方可以达到的最大信道利用率是多少?


