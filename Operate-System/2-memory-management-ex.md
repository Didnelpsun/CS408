# 内存管理习题

## 普通内存管理

### 内存管理基础知识

#### 内存管理内容

**例题** 下面关于存储管理的叙述中，正确的是()。

$A.$存储保护的目的是限制内存的分配

$B.$在内存为$M$、有$N$个用户的分时系统中，每个用户占用$M/N$的内存空间

$C.$在虚拟内存系统中，只要磁盘空间无限大，作业就能拥有任意大的编址空间

$D.$实现虚拟内存管理必须有相应硬件的支持

解：$A$限制内存的分配是存储保护，所以错误。$B$因为是分时系统，所以同一时间只有一个用户或程序，所以每个用户占有$M$的内存空间，所以错误。选项$C$中编址空间的大小取决于硬件的访存能力，一般由地址总线宽度决定。选项$D$中虚拟内存的管理需要由相关的硬件和软件支持，有请求分页页表机制、缺页中断机构、地址变换机构等。

**例题** 多进程在主存中彼此互不干扰的环境下运行，操作系统是通过()来实现的。

$A.$内存分配

$B.$内存保护

$C.$内存扩充

$D.$地址映射

解：$B$。多进程的执行通过内存保护实现互不干扰，如页式管理中有页地址越界保护，段式管理中有段地址越界保护。

**例题** 对主存储器的访问，()。

$A.$以块（即页）或段为单位

$B.$以字节或字为单位

$C.$随存储器的管理方案不同而异

$D.$以用户的逻辑记录为单位

解：$B$。注意这里指存储的访问，所以以字或字节为单位，而不是$D$。

**例题** 现有一个容量为$10GB$的磁盘分区，磁盘空间以簇为单位进行分配，簇的大小为$4KB$，若采用位图法管理该分区的空闲空间，即用一位标识一个簇是否被分配，则存放该位图所需的簇为()个。

$A.80$

$B.320$

$C.80K$

$D.320K$

解：$A$。簇的总数为$10GB/4KB=2.5M$，用一位标识一簇是否被分配，整个磁盘共需要$2.5Mb$，即需要$2.5M\div8=320KB$，因此共需要$320KB\div4KB=80$簇，选$A$。

#### 程序载入过程

**例题** 在虚拟内存管理中，地址变换机构将逻辑地址变换为物理地址，形成该逻辑地址的阶段是()。

$A.$编辑

$B.$编译

$C.$链接

$D.$装载

解：$C$。编译后的程序需要经过链接才能装载，而链接后形成的目标程序中的地址就是逻辑地址，所以是链接的过程中。若问的是完成逻辑地址到物理地址的变换的阶段就是装载。

### 内存空间分配回收

#### 动态分区分配

**例题** 在下列动态分区分配算法中，最容易产生内存碎片的是()。

$A.$首次适应算法

$B.$最坏适应算法

$C.$最佳适应算法

$D.$循环首次适应算法

解：$C$。最佳适应算法总是匹配与当前大小要求最接近的空闲分区，但是大多数情况下空闲分区的大小不可能完全和当前要求的大小相等，几乎每次分配内存都会产生很小的难以利用的内存块，所以最佳适应算法最容易产生最多的内存碎片。

#### 页式存储管理

**例题** 若页面大小$L$为$1KB$，页号$2$对应的内存块号$B=8$，将逻辑地址$A=2500$转换为物理地址$E$。

等价描述：某系统按字节寻址，逻辑地址结构中，页内偏移量占$10$位，页号$2$对应的内存块号$B=8$，将逻辑地址$A=2500$转换为物理地址$E$。

解：按照等价描述，若一个页面的页内偏移量占$10$位，所以页面大小需要$10$位来表示，即页面大小为$2^{10}B=1KB$。

第一步，计算页号和页内偏移量。页号$P=A\div L=2500\div1024=2$，页内偏移量$W=A\%L=2500\%1024=452$。

第二步，没有越界，其存放的内存块号为$8$。

第三步，物理地址$E=B\times L+W=8×1024+452=8848$。

#### 快表

**例题** 某系统使用基本分页存储管理，并采用了具有快表的地址变换机构。访问一次快表耗时$1\mu s$，访问一次内存耗时$100\mu s$。若快表的命中率为$90\%$，那么访问一个逻辑地址的平均耗时是多少？

解：若快表命中，则只用查找一次快表和一次内存，若快表不命中，则要查找一次快表和两次内存。

所以$=(1+100)\times0.9+(1+100+100)\times0.1=111\mu s$。

若该系统支持快表慢表同时查找，则为$(1+100)\times0.9+(100+100)\times0.1=110.9\mu s$。

#### 两级页表

**例题** 某计算机采用二级页表的分页存储管理方式，按字节编址，页大小为$2^{10}B$，页表项大小为$2B$，逻辑地址结构为(页目录号,页号,页内偏移量)，逻辑地址空间大小为$2^{16}$页，则表示整个逻辑地址空间的页目录表中包含表项的个数至少是()。

$A.64$

$B.128$

$C.256$

$D.512$

解：因为页面大小为$2^{10}B$，而页表项大小为$2B$，所以一页可以存在$2^9$个页表项。逻辑地址空间为$2^{16}$页，所以一共需要$2^{16}\div2^9=2^7=128$个页面来保存二级页表，所以页目录表中必须包含表项的个数至少为$128$（首级页表项）。

**例题** 某系统按字节编址，采用$40$位逻辑地址，页面大小为$4KB$，页表项大小为$4B$，假设采用纯页式存储，则要采用()级页表，页内偏移量为()位？

解：因为页面大小为$4KB=2^{12}B$，按字节编址，所以页内偏移量等于页面大小$2^{12}B$。

页号则$=40-12=28$位。

页面大小$2^{12}B$，页表项大小$4B$，则每个页面可用存放$2^{12}\div4=2^{10}$个页表项。

所以各级页表最多包含$2^{10}$个页表项，需要$10$位二进制位才能映射到$2^{10}$个页表项，因此每一级的页表对应页号应该为$10$位，$28$位的页号至少分为三级。

#### 段式存储管理

**例题** 采用分页或分段管理后，提供给用户的物理地址空间()

$A.$分页支持更大的物理地址空间

$B.$分段支持更大的物理地址空间

$C.$不能确定

$D.$一样大

解：$C$。页表和段表同样存储在内存中，系统提供给用户的物理地址空间为总空间大小减去页表或段表的长度。由于页表和段表的长度不能确定，所以提供给用户的物理地址空间大小也不能确定。

**例题** 下面的()方法有利于程序的动态链接。

$A.$分段存储管理

$B.$分页存储管理

$C.$可变式分区管理

$D.$固定式分区管理

解：$A$。程序的动态链接与程序的逻辑结构相关，分段存储管理将程序按照逻辑段进行划分，因此有利于其动态链接。其他的内存管理方式与程序的逻辑结构无关。

**例题** 可重入程序是通过()方法来改善系统性能的。

$A.$改变时间片长度

$B.$改变用户数

$C.$提高对换速度

$D.$减少对换数量

解：$D$。不能被修改的代码称为纯代码或可重入代码（不属于临界资源），这样的代码是可以共享的。可修改的代码是不能共享的（比如，有一个代码段中有很多变量，各进程并发地同时访问可能造成数据不一致）。可重入程序主要是通过共享来使用同一块存储空间的，或通过动态链接的方式将所需的程序段映射到相关进程中去，其最大的优点是减少了对程序段的调入/调出，因此减少了对换数量。

### 内存空间扩充

#### 交换技术

**例题** 在使用交换技术时，若一个进程正在()，则不能交换出主存。

$A.$创建

$B.I/O$操作

$C.$处于临界段

$D.$死锁

解：$B$。交换技术就是内存紧张时把暂时用不到的程序移动到外存中。进程正在进行$I/O$操作时不能换出主存，否则其$I/O$数据区将被新换入的进程占用，导致错误。不过可以在操作系统中开辟$I/O$缓冲区，将数据从外设输入或将数据输出到外设的$I/O$活动在系统缓冲区中进行，这时系统缓冲区与外设$I/O$时，进程交换不受限制。其中比较模糊的是$C$。只有**内核临界区**不能被换出，普通临界区可以。
